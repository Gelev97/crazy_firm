#include "network_evaluate_tof.h"


// attention stuff
#define D_MODEL 16
#define NUM_TOKENS 2
#define EPS 0.000001f // 1e-6

static float tokens[NUM_TOKENS][D_MODEL];
static float q_outputs[NUM_TOKENS][D_MODEL];
static float k_outputs[NUM_TOKENS][D_MODEL];
static float v_outputs[NUM_TOKENS][D_MODEL];
static float residual[NUM_TOKENS][D_MODEL];

static float attn_weights[NUM_TOKENS][NUM_TOKENS];
static float softmax_sums[NUM_TOKENS];
static float query_output[NUM_TOKENS][D_MODEL];
static float query_embeds[NUM_TOKENS][D_MODEL];

static float last_layer_means[NUM_TOKENS];
static float last_layer_variances[NUM_TOKENS];
static float attn_embeds[NUM_TOKENS][D_MODEL];

static float output_embeds[3 * D_MODEL];
static float obstacle_embeds[D_MODEL];
static float neighbor_embeds[D_MODEL];

float base;
float exponent;
static const int self_structure [3][2] = {{18, 16},{48, 16},{16, 4}};
static const int nbr_structure [1][2] = {{12, 16}};
static const int obst_structure [1][2] = {{32, 16}};
static const int attn_structure [4][2] = {{16, 16},{16, 16}};
static float output_0[16];
static float output_1[16];
static float output_2[4];
static const float actor_encoder_self_embed_layer_0_weight[18][16] = {{-0.010874263010919094,-0.020546479150652885,-0.33166182041168213,0.1412714272737503,-0.21769411861896515,-0.16301117837429047,-0.4128178656101227,-0.04302380606532097,-0.0012050769291818142,0.20161724090576172,-0.17262078821659088,-0.36162012815475464,-0.22176040709018707,0.052547160536050797,-0.058214589953422546,0.3410869538784027},{0.2585400938987732,-0.25168004631996155,0.7050654292106628,-0.1639227420091629,-0.3862151801586151,-0.014682596549391747,0.2834976613521576,0.029125282540917397,0.39177608489990234,0.05697888508439064,-0.37040239572525024,-0.01405168604105711,0.07995288074016571,0.354229599237442,0.4873215854167938,0.2980287969112396},{0.030552810057997704,0.13811206817626953,0.06289686262607574,0.12145133316516876,-0.6097811460494995,-0.022670606151223183,-0.13617663085460663,0.624473512172699,-0.37563765048980713,-0.30200597643852234,0.05380309745669365,-0.3338947594165802,0.040466032922267914,0.020220313221216202,-0.26449841260910034,0.47354939579963684},{0.009244858287274837,-0.21513038873672485,-0.04739055782556534,-0.2626659572124481,-0.07961635291576385,0.1536538302898407,-0.37958022952079773,-0.27847710251808167,-0.17187939584255219,-0.049038589000701904,-0.14912796020507812,0.3191947937011719,0.040523286908864975,0.07671570777893066,-0.12256479263305664,0.2391671985387802},{0.22689050436019897,-0.09565713256597519,0.1975025236606598,0.15745289623737335,-0.17660664021968842,0.004421168472617865,-0.12379217892885208,-0.10907873511314392,0.15782371163368225,-0.2475505769252777,0.09004393965005875,-0.0893874391913414,-0.33806952834129333,-0.04447057098150253,0.16739292442798615,0.30084162950515747},{0.07843436300754547,0.2662569284439087,-0.30133429169654846,0.08262117207050323,-0.10622580349445343,-0.07977864146232605,-0.2198878824710846,0.48727139830589294,-0.12136361002922058,-0.5022197365760803,0.0755903497338295,0.01947731152176857,0.04530860856175423,0.061036836355924606,-0.024134686216711998,0.3436906337738037},{-0.2573945224285126,0.047226015478372574,0.3199627697467804,-0.2762424051761627,0.2872512638568878,0.13294871151447296,0.4924449622631073,-0.18500220775604248,0.3485715389251709,-0.18825066089630127,-0.10266946256160736,-0.18875841796398163,0.02204851806163788,-0.24032869935035706,0.19332221150398254,-0.22966304421424866},{-0.22483789920806885,-0.09860002994537354,0.04491683468222618,0.02187535911798477,0.034687936305999756,0.21536017954349518,0.2156897932291031,0.24442847073078156,-0.11631731688976288,0.10788068920373917,0.09397854655981064,-0.3084729015827179,-0.035558585077524185,0.21311119198799133,-0.23622451722621918,-0.053573932498693466},{-0.023551253601908684,-0.34941476583480835,-0.12397442758083344,-0.10904058068990707,-0.36378541588783264,-0.0028385466430336237,-0.2462848275899887,-0.2628866136074066,-0.08989009261131287,0.15435297787189484,-0.20455284416675568,-0.0276808962225914,0.10804092139005661,-0.17394250631332397,0.0650661513209343,0.3573508560657501},{0.351334810256958,0.2610706388950348,-0.04770730808377266,-0.09471528232097626,-0.03702690452337265,-0.23002466559410095,0.023037906736135483,0.24717102944850922,-0.5425975322723389,0.11728547513484955,-0.19143271446228027,0.18894581496715546,-0.1698717474937439,0.386089563369751,-0.102210633456707,-0.3385172486305237},{-0.10293391346931458,-0.15507619082927704,-0.07288539409637451,0.1919049471616745,-0.3975335955619812,-0.18443453311920166,-0.13235591351985931,0.0864039734005928,-0.2987212538719177,-0.0151596050709486,0.1751422882080078,0.0983617752790451,0.17830659449100494,0.1755364090204239,-0.22378410398960114,0.10085473209619522},{-0.13512501120567322,-0.32681673765182495,-0.05889647826552391,0.14596538245677948,0.06517881900072098,-0.04495617747306824,-0.0535101555287838,0.39261317253112793,0.01750943437218666,0.17701943218708038,0.24448168277740479,-0.20445404946804047,-0.3244929909706116,0.5767267942428589,0.41780224442481995,0.07988650351762772},{0.2680712342262268,-0.07031382620334625,0.23131421208381653,0.14356230199337006,0.0933573842048645,-0.13794688880443573,0.004569098353385925,0.12826932966709137,0.16531483829021454,0.1567998230457306,-0.1730354279279709,-0.3621025085449219,0.08619336038827896,-0.2914290726184845,-0.17056328058242798,0.33377647399902344},{-0.040344804525375366,-0.1275113970041275,0.017926039174199104,0.0017861147643998265,0.027541540563106537,0.04848979786038399,-0.2271645963191986,0.23507055640220642,-0.04554701969027519,0.07568392902612686,0.15560925006866455,-0.03944649174809456,0.0016106606926769018,0.32549428939819336,-0.1535586416721344,-0.07361048460006714},{0.08100903034210205,-0.15389397740364075,-0.21466583013534546,-0.3192964196205139,0.374038428068161,0.07729578763246536,0.03851059079170227,-0.06180750951170921,-0.11281740665435791,0.42518121004104614,-0.0505678653717041,0.28900110721588135,-0.13154925405979156,0.2834703326225281,-0.08762097358703613,0.013875891454517841},{-0.49685999751091003,0.15742890536785126,-0.5185651183128357,0.5526010394096375,0.590494692325592,-0.5459923148155212,0.3597160577774048,-0.43174412846565247,0.0020039286464452744,0.05227307602763176,0.024680988863110542,-0.04929161071777344,0.5909256339073181,-0.3992289900779724,-0.39927300810813904,-0.28074881434440613},{0.25053298473358154,-0.6226533651351929,-0.3911399841308594,-0.4926917552947998,0.15839949250221252,0.015662407502532005,-0.24590997397899628,-0.1513121873140335,0.06944900751113892,-0.39020630717277527,-0.6817713379859924,-0.6187269687652588,-0.3669770359992981,-0.19664733111858368,-0.34134960174560547,-0.43441566824913025},{0.7833287119865417,0.6568321585655212,-0.05942954868078232,-0.6836255788803101,-0.25949975848197937,-1.0634664297103882,0.35511207580566406,0.07827161252498627,-0.5520168542861938,0.133016437292099,-0.10467961430549622,0.6515249609947205,-0.3454813063144684,-0.020476404577493668,0.09206981956958771,-0.6143434047698975}};
static const float actor_encoder_feed_forward_0_weight[48][16] = {{0.2686885595321655,-0.30008837580680847,0.059083256870508194,0.0022412564139813185,0.13622455298900604,-0.32369911670684814,-0.06193271279335022,0.19945074617862701,-0.17785373330116272,-0.09616705030202866,0.4136112332344055,-0.321175217628479,0.09897997230291367,0.22708983719348907,0.057615943253040314,0.1822585016489029},{0.20330959558486938,0.22070714831352234,0.3189365863800049,0.06981220096349716,-0.0018112543039023876,-0.3630563020706177,0.0534571073949337,-0.014023401774466038,0.022219615057110786,-0.24931804835796356,0.07857464253902435,0.23058819770812988,-0.13403405249118805,-0.26256096363067627,0.34004855155944824,0.09311725944280624},{0.29681265354156494,0.05970897153019905,0.12994979321956635,-0.15918707847595215,-0.19864781200885773,-0.0276357252150774,-0.0026884947437793016,-0.3025989532470703,-0.15740206837654114,0.06921848654747009,-0.0013567123096436262,0.11370043456554413,0.03736715763807297,0.06647598743438721,-0.0541718490421772,-0.09241535514593124},{0.12258244305849075,0.06481348723173141,-0.33083978295326233,-0.2193383425474167,-0.20672252774238586,-0.34322553873062134,-0.08832097798585892,-0.3410800099372864,0.17187702655792236,0.11584439873695374,-0.22569507360458374,0.059903014451265335,-0.3063242435455322,0.22373029589653015,0.22651268541812897,-0.056715864688158035},{0.2548438608646393,-0.11663684248924255,0.32006752490997314,0.12126315385103226,0.13060416281223297,0.15784713625907898,-0.16901516914367676,-0.09817686676979065,0.19468121230602264,0.29544520378112793,0.31197404861450195,0.22712834179401398,-0.6350551247596741,-0.09424829483032227,-0.20982936024665833,-0.12145256996154785},{-0.19916075468063354,0.535422146320343,-0.1369318813085556,0.04498259723186493,0.22241133451461792,-0.09735912829637527,-0.2564786672592163,0.0108867222443223,0.09765218198299408,0.010620576329529285,-0.054932601749897,-0.04943392053246498,-0.27511802315711975,0.5727691650390625,-0.2085925042629242,-0.2771846354007721},{0.26022857427597046,-0.17600372433662415,-0.20966367423534393,-0.11200753599405289,0.24447081983089447,-0.14105814695358276,-0.06106710061430931,0.09403456002473831,0.14869390428066254,-0.18388815224170685,-0.05136728286743164,0.3398134112358093,-0.021913299337029457,-0.27020710706710815,0.15675631165504456,0.18016690015792847},{-0.23402324318885803,-0.07612110674381256,-0.23200641572475433,-0.2628561854362488,-0.29682350158691406,-0.005600537173449993,-0.24257345497608185,0.03640437126159668,-0.011991233564913273,-0.3688834607601166,-0.3752833902835846,0.11153069138526917,0.4872019290924072,-0.07806354761123657,0.12932439148426056,-0.05023355036973953},{-0.12896095216274261,0.22393397986888885,0.13878847658634186,-0.25491026043891907,-0.04516610875725746,-0.1431911736726761,0.01735604740679264,-0.2565426826477051,-0.38918188214302063,0.15315359830856323,0.05646970868110657,-0.1993827223777771,-0.33244553208351135,0.09246843308210373,-0.20694291591644287,-0.2508619427680969},{0.22933202981948853,-0.24906903505325317,0.12822668254375458,-0.04399437457323074,-0.05001557618379593,0.30614638328552246,-0.23541425168514252,-0.12072491645812988,0.2055174559354782,0.3758748471736908,0.1917300969362259,-0.001528915367089212,-0.01740921102464199,0.10072801262140274,-0.10284388065338135,-0.15443842113018036},{0.20246464014053345,0.12659001350402832,0.050614964216947556,-0.1624714732170105,-0.3506057560443878,0.05503895878791809,-0.26462218165397644,-0.04701065272092819,0.13551002740859985,0.10520385950803757,0.05802292004227638,0.02095721662044525,0.06103409081697464,0.05887171998620033,0.08125703036785126,-0.0710826888680458},{0.23173798620700836,0.013960804790258408,0.3500860035419464,0.34603384137153625,-0.05248204246163368,0.18595190346240997,0.1330089420080185,-0.015823915600776672,0.1623918116092682,-0.193898007273674,0.23697170615196228,0.1550416648387909,0.15784215927124023,0.049651652574539185,-0.05421551316976547,0.3980728089809418},{0.08622530847787857,0.29336342215538025,0.1919756531715393,-0.001391371712088585,-0.2265651822090149,0.07549826055765152,-0.19653373956680298,0.09750436991453171,0.4392127990722656,0.269743412733078,-0.3598228394985199,0.541459858417511,-0.05344228819012642,0.0017564712325111032,-0.26575759053230286,0.013259715400636196},{-0.17082831263542175,0.056597474962472916,0.01888894848525524,-0.02226502262055874,-0.021349240094423294,0.10859108716249466,-0.019897673279047012,-0.13565285503864288,-0.2733926475048065,-0.2526754140853882,-0.0850466638803482,0.05234204977750778,-0.039163194596767426,-0.16132168471813202,-0.24037949740886688,0.27372169494628906},{0.2348387986421585,0.26553699374198914,-0.10575725138187408,0.1815202534198761,0.07307571172714233,0.23550580441951752,0.15532507002353668,-0.10470308363437653,-0.16533519327640533,0.024860961362719536,0.1577640175819397,-0.28638333082199097,0.20084218680858612,0.04785750061273575,0.02587161771953106,-0.09526603668928146},{-0.13349509239196777,0.39580801129341125,-0.19468998908996582,-0.09006606042385101,-0.4131902754306793,0.03741184249520302,0.04552144929766655,-0.21045689284801483,0.2250792235136032,-0.22828581929206848,-0.2459302395582199,-0.061508942395448685,0.3231775164604187,0.35231173038482666,-0.025074463337659836,-0.17731589078903198},{-0.11505969613790512,0.08558348566293716,-0.19488407671451569,-0.19066978991031647,-0.18963523209095,-0.11257859319448471,0.14037251472473145,-0.32160067558288574,0.1212724819779396,-0.13289287686347961,0.13600467145442963,-0.19655321538448334,0.12847277522087097,-0.05189628526568413,-0.24133232235908508,0.046328622847795486},{-0.03422088176012039,0.1258731633424759,-0.08294138312339783,0.06586609035730362,0.04397871717810631,-0.278422087430954,0.19545269012451172,-0.04887774586677551,-0.14344218373298645,-0.1424500048160553,0.21877427399158478,0.3212273120880127,-0.07671461999416351,0.16625849902629852,-0.07957001775503159,0.18049612641334534},{0.030437301844358444,-0.261205792427063,0.045365698635578156,0.1920228749513626,-0.22106213867664337,0.33400464057922363,-0.034001000225543976,-0.10422593355178833,0.26293104887008667,-0.03966861218214035,-0.11148692667484283,-0.0333525724709034,0.06315493583679199,0.05612028017640114,-0.32594531774520874,-0.10741778463125229},{-0.07513108849525452,0.15059813857078552,-0.3022277057170868,-0.25931745767593384,-0.11068535596132278,0.21090421080589294,0.17421011626720428,-0.04631592705845833,-0.3029184937477112,0.21145962178707123,0.15935352444648743,0.2017478346824646,0.03527029976248741,-0.24166826903820038,0.18365909159183502,-0.14951477944850922},{-0.20856955647468567,-0.13129201531410217,0.14035309851169586,-0.19022250175476074,-0.2987484633922577,-0.08414532989263535,-0.25948193669319153,0.12815971672534943,0.05761384591460228,-0.22581766545772552,-0.0231973584741354,-0.015095657669007778,0.29692426323890686,0.06394786387681961,-0.16821207106113434,0.15234065055847168},{0.31999629735946655,-0.19496509432792664,-0.14890648424625397,-0.025823790580034256,-0.08658293634653091,0.17871464788913727,-0.053775604814291,0.11344098299741745,-0.16819578409194946,-0.041669897735118866,-0.20048083364963531,-0.07851525396108627,-0.0018705406691879034,-0.14424359798431396,-0.30755093693733215,0.12942801415920258},{0.11842544376850128,0.08910699933767319,0.046733081340789795,0.129267156124115,0.08939629048109055,-0.15014787018299103,0.1760515719652176,0.11691959202289581,0.184035986661911,-0.04904765635728836,-0.11892841011285782,-0.33666330575942993,0.23109517991542816,0.11636180430650711,0.050532009452581406,0.015461906790733337},{-0.055419713258743286,-0.2910992205142975,-0.09536073356866837,0.18133597075939178,-0.17795106768608093,0.134098619222641,-0.04580772668123245,0.009398236870765686,0.012843137606978416,0.31966036558151245,0.18987756967544556,0.05777870491147041,-0.03991096839308739,0.23510371148586273,0.031728535890579224,0.0700506791472435},{-0.05489496886730194,-0.08370712399482727,0.1176656186580658,0.3064709007740021,0.23036257922649384,0.08862591534852982,0.10268156230449677,-0.25147008895874023,0.23357625305652618,-0.16233882308006287,0.14582590758800507,0.03819529339671135,0.03198796510696411,-0.20782692730426788,-0.20233719050884247,-0.262015163898468},{0.14329515397548676,-0.14390261471271515,0.08836963027715683,0.12870894372463226,0.14539900422096252,-0.17405372858047485,0.06019314378499985,0.1404886692762375,0.14685074985027313,0.4386252164840698,0.1305190771818161,-0.24929015338420868,0.1461840122938156,0.16895227134227753,0.06523395329713821,-0.047418203204870224},{0.13907569646835327,-0.043841782957315445,0.3599892556667328,0.01852571777999401,-0.06809443980455399,-0.27948302030563354,0.03426622599363327,-0.12295741587877274,0.0027980664744973183,0.12485669553279877,0.13191565871238708,-0.22853423655033112,-0.08078132569789886,-0.24726855754852295,-0.23090659081935883,-0.1516767144203186},{0.133363738656044,0.09099261462688446,-0.02948254905641079,0.24675484001636505,0.04922734946012497,-0.2086477279663086,0.2111368328332901,0.018114903941750526,-0.11644291132688522,-0.23141376674175262,0.14604000747203827,0.0853985995054245,-0.2134445309638977,-0.04756031185388565,0.1732219010591507,-0.170151948928833},{0.19354590773582458,0.0013710076455026865,-0.11333794891834259,-0.1050005853176117,-0.09010077267885208,0.06599894911050797,0.08986827731132507,0.0963277816772461,0.21607862412929535,-0.2195989042520523,-0.22735659778118134,-0.11358048766851425,-0.12446285784244537,0.017439614981412888,0.13512705266475677,0.11253777891397476},{-0.15548616647720337,-0.14108847081661224,0.1772173047065735,-0.13494527339935303,-0.0020971838384866714,0.21578359603881836,0.05004652217030525,-0.1451571136713028,0.028320902958512306,-0.02162933722138405,-0.1869523972272873,-0.03327571973204613,0.15057437121868134,-0.15468643605709076,-0.22252972424030304,0.1527571976184845},{0.1777064949274063,-0.10015007853507996,-0.1339935064315796,-0.031052174046635628,-0.1332293599843979,0.08346985280513763,-0.07711033523082733,0.21610905230045319,0.07316773384809494,-0.0472237691283226,-0.2535405457019806,0.00674034096300602,-0.16553941369056702,0.0345434732735157,0.025270778685808182,0.15986160933971405},{-0.2637634575366974,-0.015227395109832287,-0.21000143885612488,-0.22125199437141418,-0.22878439724445343,0.0709923654794693,0.014719466678798199,0.24121208488941193,-0.03264811262488365,-0.05215025320649147,-0.18401175737380981,-0.05020429193973541,0.07229834049940109,0.008328688330948353,0.217337965965271,0.33873268961906433},{0.010316837579011917,-0.21927140653133392,-0.14859634637832642,-0.1166287362575531,0.09047287702560425,0.24879321455955505,0.11585742235183716,-0.12029879540205002,0.0016281669959425926,0.24744585156440735,-0.23474712669849396,0.17566260695457458,0.01463855430483818,-0.133130744099617,0.06510071456432343,0.10372629761695862},{0.022113792598247528,0.00952963437885046,0.33003851771354675,-0.0011927426094189286,0.09660820662975311,0.04369698837399483,0.21359877288341522,-0.08946140110492706,0.003630350809544325,0.13214178383350372,-0.057859838008880615,0.09488809108734131,0.13723096251487732,0.02211710996925831,-0.0885964035987854,0.062094174325466156},{-0.2430976927280426,-0.26654598116874695,0.32515138387680054,-0.2492254078388214,0.1698494702577591,0.04866361245512962,0.1783309280872345,-0.08455731719732285,0.13141830265522003,-0.016238201409578323,-0.10503284633159637,0.19420376420021057,0.05675564706325531,0.015492700040340424,-0.15411263704299927,-0.15288977324962616},{-0.06625840067863464,-0.1659536212682724,0.1174071654677391,0.1795451045036316,0.09111492335796356,0.17399831116199493,0.0513826459646225,-0.10821625590324402,0.17418226599693298,0.27887874841690063,0.21314406394958496,-0.16685479879379272,-0.16604295372962952,-0.03366681933403015,0.2245190292596817,-0.10937557369470596},{-0.06847093999385834,-0.11782535910606384,0.09039054811000824,0.1640615016222,0.26453641057014465,0.10649127513170242,0.09729562699794769,0.19286006689071655,0.10791357606649399,0.11270039528608322,-0.14762184023857117,-0.14160557091236115,0.07499025762081146,0.14733634889125824,0.11390434205532074,0.21148836612701416},{0.028395866975188255,0.1733126938343048,0.17366278171539307,0.053995247930288315,0.10509451478719711,-0.11879310011863708,0.06654530763626099,0.15385349094867706,0.09123972058296204,-0.061342306435108185,-0.15044251084327698,-0.015571563504636288,0.023507799953222275,-0.1104644164443016,-0.07954271137714386,0.36017072200775146},{-0.10186269134283066,0.047271691262722015,0.04668790102005005,-0.09747478365898132,-0.14412304759025574,0.2449207901954651,0.10505173355340958,0.15524740517139435,-0.16266471147537231,-0.19251903891563416,-0.07243402302265167,0.006801505107432604,-0.26047635078430176,-0.09576757252216339,0.1409541815519333,0.2558048665523529},{-0.0836121141910553,0.08265870064496994,0.15038485825061798,-0.02994319424033165,0.1128278598189354,0.060277633368968964,-0.2511969208717346,0.01723450981080532,0.17601989209651947,0.11307713389396667,0.17488855123519897,-0.06185431405901909,0.029067963361740112,-0.02198774553835392,-0.02605048380792141,0.2056719809770584},{0.17827320098876953,0.14057709276676178,0.056849680840969086,0.0044661047868430614,0.036543622612953186,0.21809639036655426,0.2023078054189682,-0.10729629546403885,0.3103680908679962,0.22436870634555817,-0.027389122173190117,-0.4074535369873047,0.0017640250734984875,0.26492664217948914,0.2141370326280594,0.22051790356636047},{0.05140722915530205,-0.1306171417236328,-0.072578065097332,-0.05254695937037468,0.26137205958366394,-0.2666829824447632,0.10468652844429016,-0.18574757874011993,-0.11487262696027756,-0.12509015202522278,-0.2827740013599396,0.2339302897453308,0.04469778761267662,0.27238398790359497,0.10500603169202805,-0.2585044801235199},{-0.25973430275917053,0.01712893694639206,-0.06022045761346817,-0.10069238394498825,-0.0016064492519944906,0.024685952812433243,0.026936840265989304,-0.19030509889125824,-0.07454690337181091,-0.04025804623961449,-0.024397483095526695,-0.10461047291755676,-0.093883216381073,-0.2788369059562683,0.03921173885464668,0.24315586686134338},{-0.027434848248958588,0.18156716227531433,-0.024755431339144707,-0.053658176213502884,0.23986071348190308,-0.0670851320028305,0.21312133967876434,-0.09558285772800446,-0.04806480556726456,-0.025223499163985252,-0.09897918254137039,0.15808607637882233,0.05480370298027992,-0.10378360003232956,0.17668020725250244,0.17638333141803741},{-0.07475053519010544,-0.27330175042152405,0.01737467758357525,-0.18789583444595337,0.025527948513627052,-0.09239543229341507,0.25336432456970215,-0.26173174381256104,-0.15027981996536255,-0.1738739013671875,-0.13715271651744843,0.2401583194732666,-0.34610608220100403,-0.31337395310401917,-0.15274760127067566,-0.25866803526878357},{-0.05964593589305878,-0.20065344870090485,0.02177630551159382,0.15253500640392303,-0.2468671351671219,-0.012344910763204098,-0.11940468847751617,0.20880204439163208,-0.021007124334573746,0.07553871721029282,0.05969412997364998,0.09361016750335693,-0.05939910560846329,0.17211337387561798,-0.10777231305837631,0.11982964724302292},{-0.2207227200269699,-0.2762618064880371,0.3176400661468506,0.2282223403453827,-0.1639740914106369,-0.07129548490047455,0.04671285301446915,-0.07705602794885635,0.022395078092813492,-0.2420925498008728,0.040289945900440216,0.16584037244319916,0.07912608981132507,-0.10824110358953476,-0.14148001372814178,-0.06633203476667404},{0.08722060918807983,-0.26929739117622375,0.21071723103523254,-0.034873008728027344,-0.01362006738781929,0.1419174075126648,-0.14088991284370422,0.11934603005647659,0.11792947351932526,-0.15259084105491638,-0.19143575429916382,-0.35486820340156555,-0.25724032521247864,0.1603006273508072,0.14864549040794373,0.23076602816581726}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{0.024364499375224113,0.03465380147099495,0.13620615005493164,-0.11192531883716583},{-0.2175910323858261,0.16920937597751617,-0.18588478863239288,0.1011204794049263},{0.07167430222034454,0.17182065546512604,0.21115587651729584,0.024485910311341286},{0.08279900252819061,-0.060708481818437576,0.01577823795378208,-0.012747364118695259},{0.11892770230770111,0.2350577414035797,0.16943815350532532,0.23216252028942108},{0.08183171600103378,0.14307880401611328,0.21347002685070038,0.18297185003757477},{0.20670828223228455,-0.16944345831871033,-0.1318831741809845,-0.0817442238330841},{0.18692007660865784,-0.11443208903074265,-0.17457269132137299,0.032480914145708084},{0.03581017255783081,0.14129602909088135,-0.23691131174564362,-0.15639187395572662},{0.07194317877292633,0.10778960585594177,-0.06636176258325577,0.04098067805171013},{0.19190239906311035,-0.06374497711658478,0.16393108665943146,-0.03773187845945358},{-0.000167961698025465,0.0685308650135994,-0.02096773125231266,-0.0713992640376091},{-0.1683332473039627,-0.3250611424446106,-0.06137249618768692,-0.2628706395626068},{-0.07788334041833878,0.06789007782936096,-0.0012821971904486418,0.11515460163354874},{-0.07758297026157379,-0.026306655257940292,0.08249210566282272,-0.28995832800865173},{0.041126590222120285,-0.04594053700566292,0.1056310385465622,-0.19372859597206116}};
static const float actor_encoder_self_embed_layer_0_bias[16] = {0.04229765757918358,-0.05107607692480087,-0.008596946485340595,-0.04013456776738167,-0.016323456540703773,0.025825686752796173,-0.14363741874694824,0.059011124074459076,-0.07716970145702362,0.10357367992401123,0.014239190146327019,-0.003726932452991605,0.10608713328838348,0.12217797338962555,-0.05201607197523117,-0.04295181483030319};
static const float actor_encoder_feed_forward_0_bias[16] = {-0.048271358013153076,-0.041880350559949875,0.06999921798706055,-0.0827731341123581,0.06816481798887253,0.26722452044487,-0.024547893553972244,0.013151795603334904,-0.014305436983704567,0.06965839117765427,0.09257476031780243,0.13704170286655426,-0.047356534749269485,-0.1063513457775116,-0.027242934331297874,0.07028554379940033};
static const float action_parameterization_distribution_linear_bias[4] = {0.07106709480285645,0.0387713760137558,0.05480986461043358,0.052547574043273926};
static const float actor_encoder_neighbor_embed_layer_0_weight[12][16] = {{0.11233506351709366,-0.4555426239967346,0.20129777491092682,0.30558791756629944,0.17210857570171356,0.035664964467287064,-0.09278333932161331,-0.04040447995066643,0.38860905170440674,0.005233800504356623,-0.08692807704210281,0.440099835395813,-0.16859354078769684,-0.18899421393871307,0.36436137557029724,0.04041638597846031},{0.36541616916656494,-0.07726322114467621,-0.4659560024738312,0.2318483293056488,0.38423600792884827,-0.5108522772789001,0.05336032062768936,-0.689192533493042,-0.30734768509864807,0.03680986538529396,-0.5592334866523743,-0.2888423502445221,0.1614745557308197,-0.1973366141319275,0.16182532906532288,-0.07977915555238724},{-0.2122674286365509,-0.042601749300956726,0.56533282995224,0.09536174684762955,0.23401281237602234,-0.3061170279979706,-0.22803951799869537,-0.5008143186569214,0.3250369131565094,0.42857426404953003,-0.5058943629264832,0.19200243055820465,0.2016461342573166,-0.2564856708049774,0.3691752851009369,0.12054423987865448},{0.06280998885631561,0.131145179271698,-0.3384329378604889,-0.16567936539649963,0.4116745591163635,0.1758347600698471,-0.3647553622722626,-0.3814987540245056,-0.027256812900304794,-0.046758830547332764,-0.0953887477517128,-0.14020243287086487,0.5078769326210022,-0.3166719973087311,0.12625189125537872,-0.22881406545639038},{-0.4567081034183502,-0.23191410303115845,-0.028449157252907753,-0.40058478713035583,-0.5214874148368835,0.40637266635894775,-0.29146796464920044,0.3843880593776703,0.04945097863674164,-0.18390725553035736,0.4951891303062439,0.26015356183052063,0.01880476251244545,0.21933169662952423,-0.20634089410305023,-0.516085684299469},{-0.021579599007964134,-0.21638238430023193,0.25165215134620667,0.24026161432266235,0.07174647599458694,-0.5281034111976624,-0.11492478102445602,0.0707845613360405,-0.6379245519638062,-0.38408082723617554,-0.31026729941368103,0.07966644316911697,0.04086757451295853,-0.16833797097206116,-0.26291999220848083,0.526836633682251},{0.10597977042198181,-0.13354341685771942,0.2821142077445984,0.16396255791187286,0.1690090149641037,0.06719851493835449,0.46393534541130066,-0.2942323088645935,0.22471070289611816,-0.5427803993225098,0.24782410264015198,0.17080533504486084,-0.011873885989189148,-0.2206840217113495,0.04124646633863449,0.2763713598251343},{0.2661055028438568,-0.48238399624824524,-0.17135244607925415,0.04403718188405037,0.16427923738956451,-0.2051338255405426,-0.1774892508983612,-0.13307537138462067,-0.0718504786491394,0.022135663777589798,0.23698651790618896,-0.35413840413093567,-0.28504765033721924,0.12227840721607208,-0.1815793216228485,-0.09987226873636246},{0.037413325160741806,-0.07093840837478638,-0.34346821904182434,-0.31130459904670715,-0.4328620135784149,0.31271108984947205,0.21553663909435272,-0.3938532769680023,0.04283205047249794,-0.04398822784423828,-0.10425231605768204,0.052625857293605804,-0.0001823841594159603,-0.20990100502967834,-0.10161740332841873,0.20912206172943115},{0.1890982687473297,0.3637564182281494,-0.01775812916457653,0.2807327210903168,0.26555898785591125,-0.31492719054222107,-0.09748002886772156,-0.36953234672546387,0.31499022245407104,-0.4088144600391388,0.1685696691274643,-0.15446197986602783,0.21385619044303894,-0.07462470978498459,0.39387261867523193,0.05868103727698326},{-0.16059869527816772,0.3275085985660553,0.025943944230675697,-0.484131395816803,-0.021404212340712547,0.093965083360672,0.19296206533908844,0.45433545112609863,0.23281081020832062,0.227568119764328,-0.14165811240673065,-0.33864933252334595,-0.4302063584327698,-0.054152220487594604,0.20352652668952942,-0.053119417279958725},{-0.011528380215168,0.020854808390140533,0.15957453846931458,0.15509292483329773,-0.06923525780439377,0.19209150969982147,-0.2402704507112503,-0.35925018787384033,0.22267082333564758,0.03838775306940079,0.3033750653266907,-0.15012745559215546,-0.11144106090068817,-0.22390583157539368,0.04663373529911041,0.11700285226106644}};
static const float actor_encoder_neighbor_embed_layer_0_bias[16] = {0.04158194363117218,-0.40329045057296753,-0.04740181565284729,-0.0866483598947525,-0.04285633936524391,-0.04783708229660988,-0.23902525007724762,0.10729296505451202,0.0842171311378479,0.07714919000864029,-0.08473323285579681,-0.23628072440624237,0.17812368273735046,0.20711827278137207,-0.02651098370552063,0.028380045667290688};
static const float actor_encoder_obstacle_embed_layer_0_weight[32][16] = {{0.7521723508834839,-0.00730968127027154,-0.34897226095199585,-0.27226218581199646,0.22717683017253876,-0.24298496544361115,-0.14003673195838928,-0.04516242817044258,0.23744884133338928,0.10812772810459137,-0.15483252704143524,-0.05877729877829552,-0.2966698110103607,0.30021050572395325,-0.09286460280418396,0.08404979854822159},{0.18082736432552338,-0.19921937584877014,-0.15963636338710785,-0.023960912600159645,-0.31224000453948975,-0.2661450505256653,0.06630071997642517,0.30599454045295715,0.3077895939350128,-0.01731506548821926,0.03782544285058975,-0.06533004343509674,0.02261630818247795,0.3485764265060425,-0.06901875138282776,0.30063650012016296},{0.40655815601348877,-0.06298691034317017,-0.17411872744560242,-0.3244844973087311,-0.21555139124393463,-0.13808679580688477,-0.17002181708812714,-0.05237264186143875,0.07208628207445145,0.46979206800460815,0.086873859167099,-0.13634876906871796,-0.3562832772731781,0.4921770393848419,-0.14598916471004486,-0.3149002492427826},{0.1864837408065796,0.40613776445388794,0.06416711956262589,0.12262450158596039,0.02992151863873005,0.20360973477363586,0.08296843618154526,-0.16663755476474762,0.4137471616268158,0.011684448458254337,0.1563769280910492,-0.2510131001472473,-0.15758070349693298,0.2596082389354706,0.10098368674516678,0.16292260587215424},{-0.2574164867401123,0.01354426983743906,0.30459994077682495,0.09875849634408951,-0.3522602617740631,0.47195693850517273,-0.01749018020927906,-0.3425373136997223,0.17690220475196838,0.1565907746553421,0.4271242916584015,-0.30808761715888977,0.26180171966552734,0.06999404728412628,-0.33318614959716797,0.35289308428764343},{-0.12183687835931778,0.108780138194561,0.0671715959906578,0.2874833345413208,0.0954819917678833,-0.1345488280057907,-0.150253027677536,0.2432582825422287,-0.3394779860973358,0.10353930294513702,0.3811658024787903,0.2135816067457199,-0.13751114904880524,-0.20678067207336426,-0.09169408679008484,0.42212286591529846},{0.22109530866146088,0.35278066992759705,-0.32789677381515503,0.22234447300434113,-0.36817166209220886,-0.0282432921230793,0.39119765162467957,0.0366191528737545,0.06436905264854431,-0.4254864752292633,-0.013733704574406147,-0.02086469903588295,-0.08711954951286316,0.3787570893764496,-0.28414615988731384,-0.2059706598520279},{0.12656299769878387,0.34686312079429626,0.004006035625934601,0.06361004710197449,0.04813266918063164,0.07290145754814148,0.4859391748905182,0.25832852721214294,-0.1741834431886673,0.014501453377306461,-0.06564067304134369,0.08323954790830612,-0.29800331592559814,-0.13503846526145935,0.20403380692005157,0.13127079606056213},{0.23532696068286896,-0.31166207790374756,-0.262087881565094,0.24814529716968536,0.02885100431740284,0.0215383879840374,0.18076659739017487,0.09402395784854889,0.034803565591573715,0.05251862108707428,0.020489156246185303,-0.1456533819437027,-0.41660475730895996,-0.17511501908302307,0.08498262614011765,0.23394924402236938},{0.16693861782550812,-0.14450018107891083,-0.2909058928489685,0.4021455645561218,0.05816388502717018,0.16405093669891357,-0.06842727959156036,0.2092924565076828,-0.1635793000459671,-0.05964465066790581,-0.14335331320762634,-0.3905569016933441,0.05061344429850578,0.16999462246894836,-0.07083024084568024,-0.13132338225841522},{0.05843939259648323,0.14512333273887634,-0.04545137286186218,0.17409779131412506,-0.0702906921505928,0.13332292437553406,0.8176472187042236,0.03562165051698685,0.23161491751670837,0.13567563891410828,-0.01214408129453659,-0.2124035805463791,0.019140563905239105,-0.33876362442970276,-0.057896941900253296,-0.14189113676548004},{-0.083872489631176,0.015357138589024544,-0.2345612347126007,0.29223594069480896,-0.20332849025726318,0.44658344984054565,0.6658570170402527,-0.018441010266542435,0.22825676202774048,-0.056112147867679596,-0.18790890276432037,0.024345647543668747,0.07328558713197708,0.19662363827228546,-0.0791417583823204,0.10532175004482269},{-0.10836195200681686,0.07019980251789093,0.21659742295742035,0.2721966803073883,0.14306949079036713,0.3021888732910156,0.7056883573532104,-0.2474515587091446,0.11387532204389572,0.06089407205581665,-0.22505056858062744,0.04845872148871422,-0.2585483491420746,-0.23035161197185516,0.001201473525725305,0.21368832886219025},{0.07633297890424728,-0.08844640851020813,-0.15967944264411926,0.045410897582769394,0.31639236211776733,-0.07041186094284058,0.422362744808197,-0.368468701839447,0.30639714002609253,0.43898922204971313,-0.10979734361171722,0.07981246709823608,0.012143432162702084,0.1395542472600937,-0.3167356252670288,-0.3320299983024597},{0.2546417713165283,0.0003205490065738559,0.3383539021015167,0.1843602955341339,0.31030312180519104,0.3445756733417511,-0.22564928233623505,-0.3078140914440155,-0.17401424050331116,0.8887061476707458,-0.11664406210184097,-0.36084088683128357,-0.2766619920730591,-0.08027691394090652,-0.4621678590774536,-0.39406222105026245},{-0.21355323493480682,0.16634972393512726,0.01915096491575241,-0.31092944741249084,0.206364244222641,-0.237160786986351,0.22289642691612244,-0.162991464138031,-0.08224788308143616,0.08603829890489578,0.044543229043483734,-0.13357290625572205,-0.1775105595588684,0.3154715597629547,-0.4538338780403137,-0.19811797142028809},{0.07993432879447937,-0.20720170438289642,-0.46046319603919983,-0.001095878891646862,0.08586766570806503,-0.016634905710816383,0.2168048620223999,0.09505846351385117,-0.10221105068922043,0.02203567698597908,-0.12270715087652206,0.1890958547592163,0.1434171348810196,0.362443208694458,0.34706708788871765,0.02872811071574688},{-0.2664583623409271,-0.39806053042411804,0.047289006412029266,-0.36205342411994934,-0.27235275506973267,0.4542883634567261,0.4611577093601227,-0.1895199567079544,0.12123551964759827,0.24319639801979065,-0.35712406039237976,-0.3093539774417877,-0.4266546666622162,-0.11083807051181793,0.2856319546699524,0.127829909324646},{-0.03411945700645447,-0.1847284585237503,-0.33808156847953796,-0.26406705379486084,0.2699073553085327,0.4343399107456207,0.06571897119283676,-0.08364996314048767,0.11935881525278091,0.7022913098335266,0.08921816200017929,0.05849101021885872,-0.5899672508239746,0.2827899754047394,-0.10639453679323196,-0.2920752763748169},{0.11446945369243622,-0.5959848165512085,-0.15028198063373566,-0.0022488851100206375,-0.19429004192352295,0.3085997700691223,0.0971565768122673,-0.1949584037065506,-0.1753641664981842,0.3752710521221161,0.030802279710769653,-0.021488934755325317,-0.5125299692153931,-0.10564467310905457,-0.08451911062002182,-0.06367683410644531},{0.4091551899909973,-0.2728070914745331,0.1665552854537964,0.042854100465774536,-0.04955919459462166,-0.24677397310733795,0.2058200240135193,-0.16864775121212006,-0.0989600345492363,0.050945550203323364,-0.1952524483203888,0.06663132458925247,-0.2999005913734436,0.17833282053470612,0.19120417535305023,0.11924131959676743},{0.7255112528800964,-0.18906399607658386,-0.25085142254829407,-0.3594498336315155,0.3622344434261322,-0.2569778263568878,0.4284288287162781,-0.19966921210289001,-0.15824326872825623,0.1578739881515503,-0.09967513382434845,0.14869040250778198,-0.45837080478668213,0.14149974286556244,-0.4281058609485626,0.2902526557445526},{0.30456531047821045,0.055523358285427094,-0.14342175424098969,-0.08014090359210968,0.04384278506040573,-0.15541288256645203,0.07148806750774384,0.16068626940250397,0.34619152545928955,-0.1309182196855545,0.2716682255268097,-0.20585940778255463,0.18567806482315063,0.2960113286972046,-0.059417225420475006,-0.366694837808609},{-0.023479599505662918,-0.45466622710227966,-0.11367148160934448,-0.24152065813541412,-0.2001282125711441,0.32757025957107544,0.3892676532268524,0.14532136917114258,0.0613941065967083,0.2443174123764038,0.35112133622169495,-0.34589284658432007,0.14176824688911438,0.2672116756439209,0.026768380776047707,-0.2340031862258911},{0.277641624212265,0.04193161800503731,0.15851233899593353,0.18878936767578125,0.14151282608509064,-0.2786393463611603,-0.1453387439250946,-0.04540620744228363,-0.2739320695400238,0.1793215125799179,-0.05258932337164879,-0.15516534447669983,-0.1690819412469864,0.2750660181045532,0.46248340606689453,0.15051443874835968},{-0.043000977486371994,0.2178485244512558,0.24440734088420868,0.16822242736816406,-0.040158696472644806,-0.27274730801582336,0.08788330107927322,-0.10230972617864609,-0.17964963614940643,0.030560512095689774,0.015931472182273865,-0.18998943269252777,-0.15981531143188477,-0.3461626172065735,0.3002912104129791,0.2055496722459793},{0.11823636293411255,0.24265676736831665,0.12422541528940201,-0.2755827009677887,0.08060239255428314,0.05775182694196701,0.2698776423931122,0.30941107869148254,0.07617779076099396,-0.23883028328418732,-0.020633671432733536,-0.018666571006178856,-0.0381755568087101,0.04174967110157013,-0.01141952071338892,0.02069023996591568},{0.45721009373664856,-0.13155952095985413,-0.13620774447917938,-0.2747005820274353,-0.23396559059619904,0.2062664031982422,-0.07802265137434006,-0.2759929299354553,-0.34427350759506226,0.20334945619106293,0.11524150520563126,0.4640113115310669,-0.7485182285308838,0.38805532455444336,-0.15829716622829437,-0.17289644479751587},{0.31593194603919983,-0.20558883249759674,0.4075740873813629,-0.3565899431705475,0.21274404227733612,0.14045822620391846,-0.07203884422779083,-0.11097878962755203,0.06413358449935913,0.30621665716171265,0.14998148381710052,-0.03625493869185448,-0.30137670040130615,-0.35521388053894043,0.0461246632039547,0.16731157898902893},{0.13248349726200104,-0.3294680416584015,0.3920849561691284,0.29540470242500305,-0.09635645896196365,-0.12384483218193054,-0.22619201242923737,0.40228185057640076,-0.13316142559051514,0.18761183321475983,0.12133233994245529,-0.06773639470338821,0.06652127951383591,-0.3167792856693268,-0.15204812586307526,0.05044275522232056},{-0.00743972510099411,-0.25053417682647705,0.06268065422773361,0.07927589863538742,-0.42814818024635315,-0.16281011700630188,0.2694230079650879,0.12970572710037231,0.18986347317695618,0.12802104651927948,0.13394927978515625,0.05657990649342537,0.21194009482860565,0.16049762070178986,-0.2264774739742279,-0.22969813644886017},{-0.07001141458749771,-0.34653663635253906,-0.1355590671300888,-0.26950180530548096,-0.06157907843589783,-0.39895549416542053,-0.1724170595407486,0.1380644589662552,0.27316799759864807,-0.11999388039112091,0.09859222173690796,0.35410091280937195,-0.45814618468284607,-0.28977838158607483,0.1832204908132553,0.228127583861351}};
static const float actor_encoder_obstacle_embed_layer_0_bias[16] = {0.5386217832565308,-0.38080862164497375,-0.04231422021985054,-0.15785706043243408,-0.01150047779083252,0.004620756953954697,0.4055798351764679,0.014420481398701668,0.164073184132576,0.25553104281425476,0.2287798672914505,-0.10533186048269272,-0.2551944851875305,0.4663873612880707,0.01871616207063198,-0.08592163771390915};
static const float actor_encoder_attention_layer_w_qs_weight[16][16] = {{0.24627135694026947,-0.052832216024398804,-0.19042809307575226,0.3650253117084503,-0.287018358707428,0.13915526866912842,0.1287699043750763,-0.29280126094818115,-0.11153550446033478,-0.2813950181007385,0.36531487107276917,0.07878843694925308,0.0776350200176239,0.23866313695907593,0.2677975296974182,0.32170370221138},{0.039419353008270264,-0.09065806865692139,-0.1191127672791481,-0.13973800837993622,-0.201689213514328,-0.06135571748018265,-0.4361687898635864,-0.06432720273733139,-0.15027055144309998,0.17250370979309082,-0.08545070141553879,0.2369278371334076,0.005336232949048281,-0.034578099846839905,0.32165631651878357,-0.14640536904335022},{-0.1389116495847702,0.2781626880168915,0.2986298203468323,0.33188214898109436,0.25537675619125366,-0.3296302258968353,-0.2985472083091736,0.19301065802574158,0.12187349051237106,-0.2272622287273407,-0.18063007295131683,-0.3081173300743103,-0.3957373797893524,-0.23358583450317383,-0.11662378907203674,-0.16971628367900848},{0.08265068382024765,0.173493430018425,-0.2002231478691101,0.016215799376368523,0.02616451121866703,0.39758551120758057,0.2844575047492981,-0.24770410358905792,0.310234010219574,0.14804258942604065,0.09234471619129181,-0.07236100733280182,-0.14887137711048126,-0.059373605996370316,0.22597983479499817,-0.25555604696273804},{-0.21565963327884674,-0.3646993935108185,-0.06074855476617813,0.04613098129630089,-0.14424780011177063,-0.3278256356716156,0.0535564199090004,-0.47587892413139343,-0.32205694913864136,-0.23516538739204407,0.10585607588291168,0.15718699991703033,0.3640499413013458,0.14468611776828766,0.05301821604371071,-0.24626383185386658},{-0.3046463429927826,-0.22475968301296234,-0.23774310946464539,-0.32841500639915466,0.09477613121271133,0.21329404413700104,-0.22398334741592407,-0.467879980802536,0.1258075088262558,0.14513792097568512,0.18014629185199738,0.03677162528038025,-0.4478093981742859,0.07265400886535645,0.0035913470201194286,-0.5191065073013306},{0.17919209599494934,0.005900813266634941,0.42443403601646423,-0.14641472697257996,0.1814257651567459,0.19652105867862701,-0.12055031210184097,-0.2067253589630127,-0.3622280955314636,0.32107922434806824,-0.051715828478336334,0.20759685337543488,-0.4159141778945923,-0.383215069770813,0.358105331659317,0.358394056558609},{-0.06150291487574577,0.37892720103263855,-0.17313914000988007,-0.0791650339961052,-0.36714380979537964,-0.22089721262454987,0.2533925175666809,-0.15267087519168854,-0.12356892228126526,-0.388101726770401,0.11213469505310059,-0.2597789466381073,-0.16485486924648285,0.14705979824066162,-0.12128464132547379,-0.02720046229660511},{-0.21351595222949982,-0.23640336096286774,0.3733551800251007,0.32279491424560547,-0.018254632130265236,0.033671777695417404,0.1877465844154358,0.16886863112449646,0.21010510623455048,-0.3587794005870819,0.47045502066612244,0.22189559042453766,0.12571151554584503,0.42058777809143066,0.3826119005680084,-0.12155706435441971},{-0.02852448634803295,0.259014368057251,0.1369394212961197,0.13545626401901245,-0.23740078508853912,-0.19663000106811523,0.3078198730945587,0.5310496687889099,0.30759182572364807,-0.1328856199979782,-0.05445917323231697,-0.15808811783790588,0.19380584359169006,0.22329795360565186,-0.38763824105262756,0.22411353886127472},{-0.4107685983181,0.15426643192768097,-0.3580855429172516,0.10978253185749054,-0.07744092494249344,0.25881409645080566,-0.2751045823097229,0.0913630798459053,0.48750051856040955,-0.0702841728925705,0.5622656345367432,-0.11253692209720612,-0.044196393340826035,0.4504315257072449,-0.14644820988178253,0.058569613844156265},{-0.2003522366285324,0.4388720989227295,0.25453782081604004,0.5225217342376709,-0.13322971761226654,-0.43507999181747437,0.036028437316417694,0.3447381258010864,-0.422463983297348,-0.2734893262386322,0.20231877267360687,-0.0026097288355231285,0.0966959223151207,-0.01160135306417942,0.3010486662387848,0.17630892992019653},{-0.27490630745887756,0.05975201725959778,-0.49037447571754456,0.08368191868066788,-0.13721565902233124,-0.1409822553396225,0.3578333258628845,-0.424545556306839,-0.08576980233192444,-0.013061684556305408,-0.5387755036354065,0.33340370655059814,0.2934057414531708,0.35146403312683105,0.31181561946868896,0.2861647307872772},{0.007105118595063686,0.41576093435287476,0.49767571687698364,0.32328495383262634,0.10889281332492828,0.205746129155159,0.15753233432769775,-0.2471635341644287,-0.3212582767009735,0.402823805809021,-0.13434021174907684,0.33053863048553467,-0.19380417466163635,0.2852862775325775,0.11721057444810867,0.3503958284854889},{0.04288777336478233,-0.15600115060806274,0.013189669698476791,0.39255011081695557,0.3913300037384033,-0.3209937810897827,0.29063287377357483,0.025681786239147186,0.2724440395832062,0.15542522072792053,0.22823724150657654,0.3419214189052582,-0.29314374923706055,-0.33094483613967896,-0.15285997092723846,-0.39219093322753906},{-0.024953432381153107,0.11055205762386322,0.06906820088624954,0.43910861015319824,0.3574170768260956,-0.2924564480781555,-0.13870570063591003,-0.002515760948881507,0.07132520526647568,0.2692408263683319,-0.22723054885864258,-0.041485898196697235,0.21439646184444427,-0.23852801322937012,0.2772846817970276,-0.4077616333961487}};
static const float actor_encoder_attention_layer_w_ks_weight[16][16] = {{0.2811545133590698,0.19030167162418365,0.17861445248126984,-0.31874942779541016,0.3406805098056793,0.25456348061561584,-0.2871769368648529,-0.055079299956560135,0.02842806652188301,0.11530937254428864,0.3969481289386749,-0.21782703697681427,-0.10579255223274231,0.444843053817749,0.3385624885559082,-0.27591603994369507},{0.3510218858718872,-0.22286784648895264,0.49239274859428406,-0.0874173566699028,-0.1324167251586914,-0.09211929887533188,-0.057955753058195114,-0.15062949061393738,-0.36854517459869385,0.20713603496551514,-0.08550301939249039,0.3289516270160675,0.1411718726158142,0.17533710598945618,-0.3737603425979614,0.2367418110370636},{0.23797358572483063,-0.3022288680076599,-0.18605417013168335,-0.3131358325481415,0.238865464925766,0.11719027161598206,0.3895300030708313,-0.5001736283302307,0.2525772154331207,-0.19142034649848938,0.1676773726940155,-0.4172566533088684,0.2724127769470215,-0.3817421495914459,0.3232285976409912,0.09398794919252396},{-0.3702153265476227,0.2143283188343048,-0.3090607225894928,0.16318091750144958,0.21149636805057526,-0.24498167634010315,-0.3990400433540344,0.4278053641319275,0.14129815995693207,-0.11483047902584076,0.18665634095668793,0.2074001580476761,0.12392725050449371,0.024969343096017838,0.21948577463626862,0.2880169451236725},{0.2955726981163025,0.42968320846557617,0.38893628120422363,0.13010944426059723,-0.4002789855003357,-0.1266029328107834,0.11526588350534439,0.3203783929347992,0.0005534958909265697,-0.09740416705608368,-0.4296552836894989,0.12234625965356827,0.0719926655292511,-0.31392714381217957,-0.04774404317140579,0.40621453523635864},{0.07997621595859528,-0.3121449649333954,0.12657684087753296,-0.2611037790775299,-0.10628073662519455,0.0482625886797905,-0.13858634233474731,-0.26865309476852417,-0.1737782508134842,0.21351386606693268,-0.24848145246505737,0.16701684892177582,-0.24998430907726288,0.10837686061859131,0.10030543804168701,-0.29616278409957886},{0.16807900369167328,-0.1982395499944687,0.02238353155553341,-0.11422540992498398,0.29936859011650085,-0.2368849813938141,-0.3059399724006653,0.09849539399147034,0.15395492315292358,0.07177525013685226,0.4107767939567566,-0.3662576377391815,-0.44455450773239136,0.1279081404209137,0.11279334127902985,0.23307888209819794},{0.005933802109211683,-0.20991885662078857,-0.3620331883430481,-0.34676671028137207,-0.23966722190380096,0.42519986629486084,-0.18973422050476074,0.3482271730899811,0.36484238505363464,-0.10813918709754944,-0.19335120916366577,0.16365274786949158,-0.15074358880519867,0.3876120150089264,0.07431133836507797,-0.07636676728725433},{-0.3388955593109131,-0.1001364141702652,-0.25720667839050293,-0.0392589196562767,-0.3039013743400574,0.13642089068889618,-0.4093741774559021,-0.12739454209804535,-0.04568411037325859,-0.31165432929992676,-0.4166138172149658,0.13640804588794708,0.12102667987346649,0.26105785369873047,-0.1408950239419937,0.16083519160747528},{-0.1526205837726593,-0.17110641300678253,-0.26994356513023376,-0.3884091079235077,-0.1872103065252304,-0.03293630853295326,-0.4999523460865021,-0.29270753264427185,-0.21764510869979858,0.2565482258796692,0.11129898577928543,-0.16598299145698547,-0.01710532046854496,0.02711183950304985,-0.14086471498012543,0.25180456042289734},{0.011141318827867508,-0.37492719292640686,-0.05767989903688431,-0.139217346906662,-0.3362680673599243,-0.03833702206611633,-0.1538442075252533,-0.13894131779670715,0.2914440333843231,0.19904881715774536,-0.12515339255332947,0.11412398517131805,0.07585876435041428,0.2994280755519867,-0.20843558013439178,0.19155600666999817},{0.482360303401947,-0.3723967671394348,0.06998798996210098,0.03044670820236206,0.3959729075431824,-0.09802795946598053,0.12861500680446625,-0.15146572887897491,-0.02988985739648342,0.16815058887004852,0.09134205430746078,0.14799095690250397,0.3508814573287964,0.20852802693843842,0.11713050305843353,0.2959862947463989},{0.29635077714920044,0.07912016659975052,-0.022187333554029465,-0.23991137742996216,0.10374422371387482,-0.5917650461196899,-0.2438981533050537,0.2212408185005188,-0.10958307236433029,-0.3253908157348633,0.1419336199760437,-0.26153790950775146,0.5068995952606201,-0.047880761325359344,-0.2739703357219696,0.011919910088181496},{-0.24864983558654785,0.07864189147949219,0.5413420796394348,0.07141589373350143,0.014330949634313583,0.11315283924341202,-0.01861266978085041,-0.09560073912143707,0.014577512629330158,-0.37233924865722656,0.504991352558136,0.31738629937171936,-0.16393129527568817,0.09949314594268799,0.16191521286964417,-0.23640838265419006},{-0.30194345116615295,-0.28394463658332825,0.3319549858570099,-0.157004714012146,-0.16180241107940674,0.4106677770614624,0.3815585970878601,-0.10175228863954544,-0.16977666318416595,0.12369664013385773,-0.09764070808887482,-0.13832561671733856,-0.31898772716522217,0.37437090277671814,0.27788010239601135,-0.3367135226726532},{0.044875796884298325,-0.5820533633232117,0.05602811649441719,-0.08160483092069626,-0.11587556451559067,-0.028416156768798828,0.3095957934856415,-0.4872528910636902,0.11434757709503174,0.036677002906799316,-0.37098023295402527,0.21310415863990784,0.3391694724559784,-0.36210212111473083,-0.09392339736223221,-0.3076189160346985}};
static const float actor_encoder_attention_layer_w_vs_weight[16][16] = {{0.35460609197616577,0.006578699219971895,0.5163214206695557,0.4162532091140747,-0.3436604142189026,-0.44212204217910767,0.07298994064331055,-0.3739458918571472,0.16980834305286407,-0.05521760880947113,-0.3604881763458252,0.03182488679885864,-0.32794153690338135,0.09284865856170654,0.10212571918964386,-0.11127007752656937},{-0.2673546075820923,0.14664755761623383,-0.13181209564208984,0.1848795861005783,0.06528450548648834,0.1614435315132141,-0.020969267934560776,0.18181025981903076,0.062358222901821136,0.10224342346191406,0.03002525493502617,-0.1514168083667755,-0.15413188934326172,-0.26170262694358826,-0.2630440592765808,0.08484259247779846},{0.16067463159561157,-0.029510727152228355,-0.1790958046913147,0.4099772274494171,0.1937921792268753,-0.23661692440509796,-0.24884411692619324,-0.2322378158569336,0.18925422430038452,0.31811395287513733,-0.0694890096783638,0.5950363278388977,-0.09616159647703171,0.030457504093647003,-0.48947873711586,-0.14986491203308105},{-0.2545992136001587,0.4993319809436798,-0.47196048498153687,0.16020357608795166,0.489168256521225,-0.22787152230739594,0.25006672739982605,-0.04411666467785835,-0.2245216965675354,0.39539167284965515,0.06168775260448456,0.34596216678619385,-0.34783533215522766,-0.36256641149520874,-0.022076256573200226,0.3222687244415283},{0.09399611502885818,0.07746469974517822,0.11276537925004959,0.0041319867596030235,0.3486057221889496,0.3983252942562103,-0.2396409511566162,-0.4272342324256897,-0.24398793280124664,0.05973181128501892,0.11442246288061142,0.06420145183801651,-0.12526844441890717,-0.3971308469772339,-0.4234360158443451,-0.17269107699394226},{-0.28996768593788147,-0.26397812366485596,-0.036565206944942474,-0.4009067118167877,0.30398717522621155,-0.2926678955554962,-0.5313679575920105,0.30667126178741455,-0.07727278769016266,-0.37473323941230774,0.18817873299121857,0.11550749093294144,-0.15735763311386108,-0.11763934791088104,0.06470487266778946,-0.0728728398680687},{-0.2703736424446106,-0.08222933858633041,-0.19227401912212372,0.02052842266857624,-0.12290886789560318,0.2114032655954361,-0.14603155851364136,0.052956610918045044,0.007744772359728813,-0.2918629050254822,-0.32473456859588623,-0.346674382686615,-0.40111202001571655,0.195285826921463,0.0839180052280426,-0.05269848182797432},{0.07175002992153168,0.3251185417175293,-0.1503974348306656,0.3540371060371399,-0.39938443899154663,-0.16643653810024261,0.16832686960697174,0.04721637815237045,-0.16544482111930847,-0.2639883756637573,0.042287517338991165,0.26198461651802063,-0.21232354640960693,0.13333235681056976,0.5425955653190613,0.39261311292648315},{-0.22315098345279694,-0.33440864086151123,0.13721075654029846,-0.13627952337265015,0.08167868107557297,-0.46722283959388733,-0.06775995343923569,-0.23308636248111725,-0.11225856840610504,0.36439061164855957,-0.45087236166000366,0.05197298154234886,0.15669646859169006,0.1083221286535263,0.2640816569328308,0.05841239169239998},{0.3347024917602539,-0.3308369517326355,-0.293619841337204,0.019179919734597206,-0.3576250374317169,0.05362819507718086,0.2550719380378723,-0.22884292900562286,-0.22860151529312134,0.15187640488147736,0.2591598927974701,-0.31211578845977783,0.10439924895763397,0.05175451189279556,-0.40878960490226746,-0.10695798695087433},{-0.14782291650772095,0.4655561149120331,0.22132006287574768,-0.07737874239683151,-0.4864356219768524,0.020162850618362427,0.04264748841524124,0.4781530499458313,-0.27058321237564087,0.13644473254680634,0.41121578216552734,0.0023043579421937466,-0.2417856901884079,0.04514487460255623,0.36601024866104126,-0.1579468697309494},{-0.24779143929481506,0.4934941530227661,-0.24238699674606323,0.3945886790752411,0.21324510872364044,-0.11552733182907104,-0.09026249498128891,-0.25938618183135986,-0.17944948375225067,-0.22016172111034393,0.1574629694223404,0.27453866600990295,0.3634182810783386,0.4719303250312805,-0.045477863401174545,-0.04004345461726189},{0.10135789215564728,-0.315194696187973,-0.41052547097206116,0.28372809290885925,-0.31636306643486023,0.0108985910192132,-0.22526273131370544,0.39939743280410767,-0.17061477899551392,0.41193920373916626,-0.3728713095188141,0.41838452219963074,-0.2588597536087036,-0.033482860773801804,-0.047310031950473785,-0.24849523603916168},{0.1826016753911972,0.11996322125196457,0.24704790115356445,-0.32708972692489624,-0.30863767862319946,-0.5214754939079285,0.23777242004871368,-0.09802556782960892,-0.1704503446817398,-0.4750627279281616,-0.2750697433948517,-0.421146035194397,-0.2786942720413208,0.38801684975624084,0.3381339907646179,0.3848073482513428},{-0.31114786863327026,-0.2184276282787323,-0.26584216952323914,0.38013991713523865,-0.22212103009223938,-0.047772254794836044,-0.04440246894955635,-0.1463710218667984,-0.07174092531204224,-0.14252038300037384,0.31977152824401855,-0.24687731266021729,-0.3062330186367035,0.11871741712093353,-0.24884919822216034,0.4557492434978485},{-0.12923841178417206,0.051587123423814774,0.03743387386202812,0.523798406124115,-0.2844773232936859,0.2865183651447296,0.1757500171661377,0.06942637264728546,-0.21601852774620056,-0.0027178600430488586,-0.18573923408985138,0.39564961194992065,-0.00867075752466917,0.006238705012947321,0.15991632640361786,0.26093152165412903}};
static const float actor_encoder_attention_layer_fc_weight[16][16] = {{0.4134488105773926,-0.306978315114975,-0.12720714509487152,-0.17326577007770538,0.2266985923051834,0.2511283755302429,0.33341971039772034,0.2494327425956726,0.022831209003925323,0.536608099937439,-0.15038442611694336,-0.26798272132873535,0.39549675583839417,0.24120628833770752,0.11558683961629868,0.1606922298669815},{0.12848974764347076,0.3577580451965332,0.31612786650657654,-0.126091867685318,-0.13829457759857178,-0.3726726472377777,-0.025398381054401398,0.014851342886686325,-0.06039150431752205,-0.6857067942619324,0.02939019165933132,-0.21520844101905823,-0.19945921003818512,-0.24519005417823792,0.04446664825081825,-0.06154672056436539},{0.4014005661010742,-0.5944194793701172,-0.18784664571285248,-0.35532352328300476,0.23273982107639313,0.28664466738700867,0.38389867544174194,0.2949278950691223,0.15565960109233856,-0.13907738029956818,-0.17100031673908234,-0.3070200979709625,0.15374453365802765,-0.36259347200393677,0.4543308615684509,0.042152903974056244},{0.08058382570743561,0.0934695452451706,-0.3619886338710785,0.3374369442462921,0.2833443880081177,0.2288423329591751,-0.16486454010009766,-0.1878841519355774,0.3107622563838959,-0.3129914700984955,-0.4454626739025116,-0.10773696005344391,0.16451206803321838,0.42751431465148926,-0.09028394520282745,0.12080688029527664},{-0.061121866106987,0.6338303685188293,-0.4497587978839874,0.4271605908870697,-0.4187568724155426,-0.5099769234657288,0.10018004477024078,-0.003658998990431428,0.06958971917629242,0.4464690685272217,-0.005659463815391064,0.35039618611335754,0.24965006113052368,-0.42905744910240173,0.3384515643119812,0.22778098285198212},{0.29560697078704834,0.41589149832725525,-0.3270830810070038,0.31932318210601807,-0.19490960240364075,-0.014325778931379318,-0.2820732593536377,0.0312623456120491,-0.265322744846344,-0.32826653122901917,0.2265969216823578,0.19605182111263275,0.15483015775680542,-0.03401865065097809,0.3181690275669098,-0.4456443190574646},{0.06609664112329483,-0.22868308424949646,0.10579963028430939,0.19005107879638672,-0.16363948583602905,0.2908974885940552,0.40989795327186584,0.17316125333309174,-0.06301990896463394,-0.10304856300354004,-0.43163859844207764,0.12145695835351944,0.10593250393867493,0.16873086988925934,0.1600428819656372,0.20755475759506226},{-0.39053860306739807,0.3442106246948242,0.035467155277729034,-0.1992732584476471,-0.0417514443397522,-0.19215668737888336,-0.3983707129955292,0.4045233130455017,0.08702986687421799,-0.3637908697128296,-0.3031475245952606,0.23679256439208984,-0.23754450678825378,0.05528467893600464,0.3174203336238861,0.09463339298963547},{-0.02914721705019474,0.2542635500431061,-0.017497414723038673,-0.12616479396820068,-0.2337522804737091,-0.29527023434638977,-0.19893701374530792,-0.25308993458747864,0.029133867472410202,0.18010245263576508,-0.32304146885871887,0.18842145800590515,-0.11381801962852478,-0.2710822820663452,0.3218255341053009,0.0515187606215477},{-0.40997543931007385,0.20669478178024292,-0.3101174235343933,0.4443780183792114,0.09857762604951859,-0.3423580229282379,-0.0781259834766388,-0.37112054228782654,-0.10885491222143173,0.09403908252716064,-0.22258754074573517,-0.23795825242996216,0.37108710408210754,-0.28408893942832947,-0.04290751367807388,0.0608426108956337},{0.055446408689022064,0.007096579298377037,0.3670975863933563,0.0018014947418123484,0.16041594743728638,-0.0336691215634346,-0.17479053139686584,0.3210885226726532,0.009420057758688927,-0.4719562530517578,0.23790399730205536,0.4106582999229431,-0.4054863750934601,-0.34944668412208557,-0.36948534846305847,-0.4671962261199951},{0.19044816493988037,0.24673497676849365,0.25196272134780884,0.49005770683288574,-0.19902339577674866,-0.012156684882938862,-0.4338192641735077,-0.34791406989097595,0.027636924758553505,-0.2398827075958252,-0.010868112556636333,0.17874832451343536,-0.3994005620479584,0.3916490375995636,-0.05088313668966293,-0.28073054552078247},{0.4063701331615448,0.20952272415161133,0.31537774205207825,-0.23821383714675903,0.010143117047846317,0.012642824091017246,-0.25808799266815186,-0.006161961704492569,0.2834528386592865,0.007849306799471378,0.21306349337100983,-0.18870094418525696,0.1697661429643631,-0.2815918028354645,0.21805104613304138,-0.04350364953279495},{0.09449321776628494,-0.34200987219810486,0.3227575719356537,-0.13263915479183197,0.36759814620018005,-0.02092643640935421,-0.019534673541784286,0.0853346735239029,-0.10105464607477188,-0.4832991063594818,-0.07545308768749237,-0.37799108028411865,0.09150150418281555,0.09847719222307205,-0.028857644647359848,-0.06261991709470749},{-0.4881553649902344,-0.16878673434257507,0.015314147807657719,-0.20160046219825745,0.42450907826423645,0.017534663900732994,0.5363878011703491,0.2000410258769989,0.33626610040664673,-0.4751463234424591,0.3156186044216156,0.13032419979572296,0.3209730088710785,0.12941831350326538,0.3376224637031555,0.1999921351671219},{-0.2623039484024048,-0.45696163177490234,-0.07251660525798798,-0.1334700584411621,0.03537353128194809,0.331179141998291,-0.23859180510044098,-0.3406420946121216,0.26410919427871704,-0.3346133232116699,0.28478294610977173,0.379740446805954,-0.1735541820526123,-0.04538040608167648,0.14000153541564941,-0.057350486516952515}};
static const float actor_encoder_attention_layer_layer_norm_weight[16] = {0.5415548086166382,0.2978770434856415,0.5970324873924255,0.6752679944038391,0.6037541031837463,0.45384588837623596,0.4436052739620209,0.497326135635376,0.6194972395896912,0.32028675079345703,0.3759671151638031,0.3877365291118622,0.6618609428405762,0.4168987274169922,0.5204276442527771,0.6074258685112};
static const float actor_encoder_attention_layer_layer_norm_bias[16] = {-0.003733461955562234,0.22664819657802582,0.14034982025623322,0.23741529881954193,-0.09354587644338608,-0.11307480186223984,-0.16784174740314484,0.06279273331165314,-0.00106472906190902,-0.18940496444702148,0.0383252315223217,0.12253978103399277,-0.03548061475157738,-0.023440038785338402,0.04072263091802597,-0.03332889825105667};
static const float mean[62] = {-0.019132683502845187,-0.07689674687255914,0.1294691604043937,0.0026607074271433745,-0.004771610611872414,0.0013762810804286323,-0.08509275590482364,0.000503770501813527,0.00040185074167646567,0.0003645962693957792,-0.08657658277770355,0.004866487171439437,-0.0003529113569643037,-0.0005022825096059965,-0.054987853491535274,0.01568420499230149,-0.012356320746865093,-0.007162358867555805,-0.003910403853496812,0.007713258798722592,-0.00464242441636163,0.003134251301759476,0.008649293677419087,0.0071201313700429755,-0.00030230500547690875,0.005878653746216809,0.002228333060528414,0.0005217582189171397,0.008220151288963742,0.007212648820715434,1.9213730748620228,1.9235765644755671,1.925441033351493,1.9264886909626548,1.9263459444899493,1.9251226089025626,1.9233663029487944,1.921620564676779,1.9216425031659123,1.927187819270073,1.931983493536471,1.934740439088132,1.934770653598646,1.9321276887022505,1.927544730160503,1.9222109194073758,1.9240498884217414,1.9256928962050845,1.926662637252705,1.9268473670969566,1.9264074011368548,1.925728111544447,1.9251558665103319,1.9247578341148093,1.9321739212077649,1.936409276150139,1.9390894577090325,1.9393237811110418,1.9370577032872265,1.932921877419913,1.9279221980894188,1.9230572295057202};
static const float input_std[62] = {0.6387265518524344,0.7436019265424422,0.3502694339795283,0.4814280166659065,0.6448428631955819,0.6624262545416253,0.30845158427304076,0.20410200739507087,0.16205862990206998,0.20418879086778743,0.2970519716317474,0.1892744093589645,0.16194907423504046,0.18942916426620304,0.21197470772667143,2.4695917117067006,2.591902486543421,2.882607386676119,0.7948012287609795,0.5433916720128745,0.34564620253580125,0.7241998558795604,0.8975497410395863,0.8812836159196675,1.113120992491892,0.5823846975865613,0.3658547617424655,0.6390956426900707,0.8318476953410933,0.7805514192894494,0.31171275447483093,0.30896251981507244,0.30641913300206547,0.3047947915904272,0.30461732476803355,0.3057474057246758,0.3074337423294496,0.3089403332302094,0.2887789245149161,0.2785279230490672,0.2696589139924134,0.2645704823904698,0.26463915105704966,0.2696604996695839,0.2780213648045591,0.2877042209075727,0.3041927854656847,0.30248110421256114,0.3013834045453802,0.3012118376085902,0.3018463565729959,0.30277498452958035,0.30341008066434594,0.30353680532681365,0.27577656292420044,0.26728374307244773,0.26123377631037054,0.2595688396718701,0.26290384129085653,0.2702030896767633,0.27952271710157506,0.28911808477087986};
void networkEvaluate(struct control_t_n *control_n, float *state_array) {
            // Self embed layer
            for (int i = 0; i < self_structure[0][1]; i++) {
                output_0[i] = 0;
                for (int j = 0; j < self_structure[0][0]; j++) {
                    output_0[i] += ((state_array[j] - mean[j])/input_std[j]) * actor_encoder_self_embed_layer_0_weight[j][i];
                }
                output_0[i] += actor_encoder_self_embed_layer_0_bias[i];
                output_0[i] = tanhf(output_0[i]);
            }
        
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_embeds[i] = output_0[i];
            output_embeds[i + self_structure[0][1]] = attn_embeds[0][i];
            output_embeds[i + 2 * self_structure[0][1]] = attn_embeds[1][i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < 3 * self_structure[0][1]; j++) {
                output_1[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_1[i] += actor_encoder_feed_forward_0_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
    
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_2[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_2[0];
        control_n->thrust_1 = output_2[1];
        control_n->thrust_2 = output_2[2];
        control_n->thrust_3 = output_2[3];	
    }

void neighborEmbedder(volatile float neighbor_inputs[NEIGHBORS * NBR_OBS_DIM]) {
        
                for (int i = 0; i < nbr_structure[0][1]; i++) {
                    neighbor_embeds[i] = 0; 
                    for (int j = 0; j < nbr_structure[0][0]; j++) {
                        int norm_index = j+STATE_DIM;
                        neighbor_embeds[i] += ((neighbor_inputs[j] - mean[norm_index]) / input_std[norm_index]) * actor_encoder_neighbor_embed_layer_0_weight[j][i]; 
                    }
                    neighbor_embeds[i] += actor_encoder_neighbor_embed_layer_0_bias[i];
                }
            }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
    
                for (int i = 0; i < obst_structure[0][1]; i++) {
                    obstacle_embeds[i] = 0;
                    for (int j = 0; j < obst_structure[0][0]; j++) {
                        int norm_index = j+STATE_DIM+(NEIGHBORS*NBR_OBS_DIM);
                        obstacle_embeds[i] += ((obstacle_inputs[j] - mean[norm_index]) / input_std[norm_index]) * actor_encoder_obstacle_embed_layer_0_weight[j][i];
                    }
                    obstacle_embeds[i] += actor_encoder_obstacle_embed_layer_0_bias[i];
                }
            }


void singleHeadAttention() {
        uint8_t i, j, k;
        // fill the tokens matrix with obstacle and neighbor embeddings
        for (i = 0; i < D_MODEL; i++) {
            tokens[0][i] = neighbor_embeds[i];
            tokens[1][i] = obstacle_embeds[i];
        }
        
        // save the residual
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                residual[i][j] = tokens[i][j];
            }
        }
        
        // compute Q, K, V projection 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                q_outputs[i][j] = 0;
                k_outputs[i][j] = 0;
                v_outputs[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    q_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_qs_weight[k][j]; 
                    k_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_ks_weight[k][j];
                    v_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_vs_weight[k][j];
                }
            }
        }
        
        // compute attention weights and parts of softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            softmax_sums[i] = 0;
            for (int j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    attn_weights[i][j] += (q_outputs[i][k] / sqrt((float)D_MODEL)) * k_outputs[j][k];
                }
                softmax_sums[i] += exp(attn_weights[i][j]);
            }
        }
        
        // softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = exp(attn_weights[i][j]) / softmax_sums[i];
            }
        }

        // compute query 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_output[i][j] = 0;
                for (k = 0; k < NUM_TOKENS; k++) {
                    query_output[i][j] += attn_weights[i][k] * v_outputs[k][j];
                }
            }
        }
        
        // compute the q embeddings 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_embeds[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    query_embeds[i][j] += query_output[i][k] * actor_encoder_attention_layer_fc_weight[k][j];
                }
                // add the residual
                query_embeds[i][j] += residual[i][j];
            }
        }
        
        // calculate per-token mean
        for (i = 0; i < NUM_TOKENS; i++){
            last_layer_means[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                last_layer_means[i] +=  query_embeds[i][j];
            }
            last_layer_means[i] = last_layer_means[i] / (float)D_MODEL;
        }
        
        // calculate per-token variance
        for (i = 0; i < NUM_TOKENS; i++) {
            last_layer_variances[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                base = query_embeds[i][j] - last_layer_means[i];
                exponent = pow(base, 2);
                last_layer_variances[i] += exponent;
            }
            last_layer_variances[i] = last_layer_variances[i] / (float)(D_MODEL);
        }
        
        // perform layer norm (2x16) x (16)
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                attn_embeds[i][j] = (query_embeds[i][j] - last_layer_means[i]) / (sqrt(last_layer_variances[i] + EPS)) * actor_encoder_attention_layer_layer_norm_weight[j]; 
                attn_embeds[i][j] += actor_encoder_attention_layer_layer_norm_bias[j]; 
            }
        }
}
